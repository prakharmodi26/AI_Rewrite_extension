{
  "version": 3,
  "sources": ["../../extension/src/background.ts"],
  "sourcesContent": ["import { AiActionMessage, Tone, Task, PercentLevel, SummaryLevel } from './types.js';\n\nconst PARENT_ID = 'ai_actions_parent';\nconst TONES: { id: Tone; label: string }[] = [\n  { id: 'formal', label: 'Formal' },\n  { id: 'friendly', label: 'Friendly' },\n  { id: 'confident', label: 'Confident' },\n  { id: 'persuasive', label: 'Persuasive' },\n  { id: 'casual', label: 'Casual' },\n];\nconst PERCENTS: { id: PercentLevel; label: string }[] = [10, 20, 30, 40, 50, 60].map((p) => ({ id: p as PercentLevel, label: `${p}%` }));\nconst SUMMARY_LEVELS: { id: SummaryLevel; label: string }[] = [\n  { id: 'light', label: 'Light' },\n  { id: 'medium', label: 'Medium' },\n  { id: 'heavy', label: 'Heavy' },\n];\n\nchrome.runtime.onInstalled.addListener(async () => {\n  try {\n    await chrome.contextMenus.removeAll();\n  } catch {}\n\n  chrome.contextMenus.create({\n    id: PARENT_ID,\n    title: 'AI Actions',\n    contexts: ['selection'],\n  });\n\n  // Rewrite \u2192 tones\n  chrome.contextMenus.create({ id: 'task_rewrite', parentId: PARENT_ID, title: 'Rewrite', contexts: ['selection'] });\n  for (const tone of TONES) {\n    chrome.contextMenus.create({ id: `task_rewrite_tone_${tone.id}`, parentId: 'task_rewrite', title: tone.label, contexts: ['selection'] });\n  }\n\n  // Grammar & Spelling \u2192 no submenu\n  chrome.contextMenus.create({ id: 'task_grammar', parentId: PARENT_ID, title: 'Grammar & Spelling', contexts: ['selection'] });\n\n  // Shorten \u2192 percents\n  chrome.contextMenus.create({ id: 'task_shorten', parentId: PARENT_ID, title: 'Shorten', contexts: ['selection'] });\n  for (const p of PERCENTS) {\n    chrome.contextMenus.create({ id: `task_shorten_percent_${p.id}`, parentId: 'task_shorten', title: p.label, contexts: ['selection'] });\n  }\n\n  // Expand \u2192 percents\n  chrome.contextMenus.create({ id: 'task_expand', parentId: PARENT_ID, title: 'Expand', contexts: ['selection'] });\n  for (const p of PERCENTS) {\n    chrome.contextMenus.create({ id: `task_expand_percent_${p.id}`, parentId: 'task_expand', title: p.label, contexts: ['selection'] });\n  }\n\n  // Summarize \u2192 summary levels\n  chrome.contextMenus.create({ id: 'task_summarize', parentId: PARENT_ID, title: 'Summarize', contexts: ['selection'] });\n  for (const s of SUMMARY_LEVELS) {\n    chrome.contextMenus.create({ id: `task_summarize_level_${s.id}`, parentId: 'task_summarize', title: s.label, contexts: ['selection'] });\n  }\n});\n\nchrome.contextMenus.onClicked.addListener(async (info, tab) => {\n  if (!tab?.id) return;\n  const selectionEmpty = !info.selectionText || info.selectionText.trim() === '';\n  if (selectionEmpty) {\n    await chrome.tabs.sendMessage(tab.id, { type: 'AI_TOAST', text: 'No text selected', level: 'info' });\n    return;\n  }\n  const id = String(info.menuItemId);\n  if (id === 'task_grammar') {\n    const msg: AiActionMessage = { type: 'AI_ACTION', task: 'grammar' };\n    await chrome.tabs.sendMessage(tab.id, msg);\n    return;\n  }\n\n  if (id.startsWith('task_rewrite_tone_')) {\n    const tone = id.replace('task_rewrite_tone_', '') as Tone;\n    const msg: AiActionMessage = { type: 'AI_ACTION', task: 'rewrite', tone };\n    await chrome.tabs.sendMessage(tab.id, msg);\n    return;\n  }\n\n  if (id.startsWith('task_shorten_percent_')) {\n    const p = parseInt(id.replace('task_shorten_percent_', ''), 10) as PercentLevel;\n    const msg: AiActionMessage = { type: 'AI_ACTION', task: 'shorten', percent: p };\n    await chrome.tabs.sendMessage(tab.id, msg);\n    return;\n  }\n\n  if (id.startsWith('task_expand_percent_')) {\n    const p = parseInt(id.replace('task_expand_percent_', ''), 10) as PercentLevel;\n    const msg: AiActionMessage = { type: 'AI_ACTION', task: 'expand', percent: p };\n    await chrome.tabs.sendMessage(tab.id, msg);\n    return;\n  }\n\n  if (id.startsWith('task_summarize_level_')) {\n    const s = id.replace('task_summarize_level_', '') as SummaryLevel;\n    const msg: AiActionMessage = { type: 'AI_ACTION', task: 'summarize', summary_level: s };\n    await chrome.tabs.sendMessage(tab.id, msg);\n    return;\n  }\n});\n\nchrome.commands.onCommand.addListener(async (command) => {\n  const [tab] = await chrome.tabs.query({ active: true, currentWindow: true });\n  if (!tab?.id) return;\n  if (command === 'rewrite_default') {\n    const msg: AiActionMessage = { type: 'AI_ACTION', task: 'rewrite', tone: 'friendly' };\n    await chrome.tabs.sendMessage(tab.id, msg);\n  } else if (command === 'summarize') {\n    const msg: AiActionMessage = { type: 'AI_ACTION', task: 'summarize', summary_level: 'medium' };\n    await chrome.tabs.sendMessage(tab.id, msg);\n  }\n});\n"],
  "mappings": ";AAEA,IAAM,YAAY;AAClB,IAAM,QAAuC;AAAA,EAC3C,EAAE,IAAI,UAAU,OAAO,SAAS;AAAA,EAChC,EAAE,IAAI,YAAY,OAAO,WAAW;AAAA,EACpC,EAAE,IAAI,aAAa,OAAO,YAAY;AAAA,EACtC,EAAE,IAAI,cAAc,OAAO,aAAa;AAAA,EACxC,EAAE,IAAI,UAAU,OAAO,SAAS;AAClC;AACA,IAAM,WAAkD,CAAC,IAAI,IAAI,IAAI,IAAI,IAAI,EAAE,EAAE,IAAI,CAAC,OAAO,EAAE,IAAI,GAAmB,OAAO,GAAG,CAAC,IAAI,EAAE;AACvI,IAAM,iBAAwD;AAAA,EAC5D,EAAE,IAAI,SAAS,OAAO,QAAQ;AAAA,EAC9B,EAAE,IAAI,UAAU,OAAO,SAAS;AAAA,EAChC,EAAE,IAAI,SAAS,OAAO,QAAQ;AAChC;AAEA,OAAO,QAAQ,YAAY,YAAY,YAAY;AACjD,MAAI;AACF,UAAM,OAAO,aAAa,UAAU;AAAA,EACtC,QAAQ;AAAA,EAAC;AAET,SAAO,aAAa,OAAO;AAAA,IACzB,IAAI;AAAA,IACJ,OAAO;AAAA,IACP,UAAU,CAAC,WAAW;AAAA,EACxB,CAAC;AAGD,SAAO,aAAa,OAAO,EAAE,IAAI,gBAAgB,UAAU,WAAW,OAAO,WAAW,UAAU,CAAC,WAAW,EAAE,CAAC;AACjH,aAAW,QAAQ,OAAO;AACxB,WAAO,aAAa,OAAO,EAAE,IAAI,qBAAqB,KAAK,EAAE,IAAI,UAAU,gBAAgB,OAAO,KAAK,OAAO,UAAU,CAAC,WAAW,EAAE,CAAC;AAAA,EACzI;AAGA,SAAO,aAAa,OAAO,EAAE,IAAI,gBAAgB,UAAU,WAAW,OAAO,sBAAsB,UAAU,CAAC,WAAW,EAAE,CAAC;AAG5H,SAAO,aAAa,OAAO,EAAE,IAAI,gBAAgB,UAAU,WAAW,OAAO,WAAW,UAAU,CAAC,WAAW,EAAE,CAAC;AACjH,aAAW,KAAK,UAAU;AACxB,WAAO,aAAa,OAAO,EAAE,IAAI,wBAAwB,EAAE,EAAE,IAAI,UAAU,gBAAgB,OAAO,EAAE,OAAO,UAAU,CAAC,WAAW,EAAE,CAAC;AAAA,EACtI;AAGA,SAAO,aAAa,OAAO,EAAE,IAAI,eAAe,UAAU,WAAW,OAAO,UAAU,UAAU,CAAC,WAAW,EAAE,CAAC;AAC/G,aAAW,KAAK,UAAU;AACxB,WAAO,aAAa,OAAO,EAAE,IAAI,uBAAuB,EAAE,EAAE,IAAI,UAAU,eAAe,OAAO,EAAE,OAAO,UAAU,CAAC,WAAW,EAAE,CAAC;AAAA,EACpI;AAGA,SAAO,aAAa,OAAO,EAAE,IAAI,kBAAkB,UAAU,WAAW,OAAO,aAAa,UAAU,CAAC,WAAW,EAAE,CAAC;AACrH,aAAW,KAAK,gBAAgB;AAC9B,WAAO,aAAa,OAAO,EAAE,IAAI,wBAAwB,EAAE,EAAE,IAAI,UAAU,kBAAkB,OAAO,EAAE,OAAO,UAAU,CAAC,WAAW,EAAE,CAAC;AAAA,EACxI;AACF,CAAC;AAED,OAAO,aAAa,UAAU,YAAY,OAAO,MAAM,QAAQ;AAC7D,MAAI,CAAC,KAAK,GAAI;AACd,QAAM,iBAAiB,CAAC,KAAK,iBAAiB,KAAK,cAAc,KAAK,MAAM;AAC5E,MAAI,gBAAgB;AAClB,UAAM,OAAO,KAAK,YAAY,IAAI,IAAI,EAAE,MAAM,YAAY,MAAM,oBAAoB,OAAO,OAAO,CAAC;AACnG;AAAA,EACF;AACA,QAAM,KAAK,OAAO,KAAK,UAAU;AACjC,MAAI,OAAO,gBAAgB;AACzB,UAAM,MAAuB,EAAE,MAAM,aAAa,MAAM,UAAU;AAClE,UAAM,OAAO,KAAK,YAAY,IAAI,IAAI,GAAG;AACzC;AAAA,EACF;AAEA,MAAI,GAAG,WAAW,oBAAoB,GAAG;AACvC,UAAM,OAAO,GAAG,QAAQ,sBAAsB,EAAE;AAChD,UAAM,MAAuB,EAAE,MAAM,aAAa,MAAM,WAAW,KAAK;AACxE,UAAM,OAAO,KAAK,YAAY,IAAI,IAAI,GAAG;AACzC;AAAA,EACF;AAEA,MAAI,GAAG,WAAW,uBAAuB,GAAG;AAC1C,UAAM,IAAI,SAAS,GAAG,QAAQ,yBAAyB,EAAE,GAAG,EAAE;AAC9D,UAAM,MAAuB,EAAE,MAAM,aAAa,MAAM,WAAW,SAAS,EAAE;AAC9E,UAAM,OAAO,KAAK,YAAY,IAAI,IAAI,GAAG;AACzC;AAAA,EACF;AAEA,MAAI,GAAG,WAAW,sBAAsB,GAAG;AACzC,UAAM,IAAI,SAAS,GAAG,QAAQ,wBAAwB,EAAE,GAAG,EAAE;AAC7D,UAAM,MAAuB,EAAE,MAAM,aAAa,MAAM,UAAU,SAAS,EAAE;AAC7E,UAAM,OAAO,KAAK,YAAY,IAAI,IAAI,GAAG;AACzC;AAAA,EACF;AAEA,MAAI,GAAG,WAAW,uBAAuB,GAAG;AAC1C,UAAM,IAAI,GAAG,QAAQ,yBAAyB,EAAE;AAChD,UAAM,MAAuB,EAAE,MAAM,aAAa,MAAM,aAAa,eAAe,EAAE;AACtF,UAAM,OAAO,KAAK,YAAY,IAAI,IAAI,GAAG;AACzC;AAAA,EACF;AACF,CAAC;AAED,OAAO,SAAS,UAAU,YAAY,OAAO,YAAY;AACvD,QAAM,CAAC,GAAG,IAAI,MAAM,OAAO,KAAK,MAAM,EAAE,QAAQ,MAAM,eAAe,KAAK,CAAC;AAC3E,MAAI,CAAC,KAAK,GAAI;AACd,MAAI,YAAY,mBAAmB;AACjC,UAAM,MAAuB,EAAE,MAAM,aAAa,MAAM,WAAW,MAAM,WAAW;AACpF,UAAM,OAAO,KAAK,YAAY,IAAI,IAAI,GAAG;AAAA,EAC3C,WAAW,YAAY,aAAa;AAClC,UAAM,MAAuB,EAAE,MAAM,aAAa,MAAM,aAAa,eAAe,SAAS;AAC7F,UAAM,OAAO,KAAK,YAAY,IAAI,IAAI,GAAG;AAAA,EAC3C;AACF,CAAC;",
  "names": []
}
